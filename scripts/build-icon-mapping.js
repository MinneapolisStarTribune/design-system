const fs = require('fs');
const path = require('path');

const iconsDir = path.join(__dirname, '../src/icons');
const iconOptionsFile = path.join(__dirname, '../src/components/Icon/iconOptions.ts');
const iconNamesFile = path.join(__dirname, '../src/components/Icon/iconNames.ts');

// Get all SVG files
const svgFiles = fs
  .readdirSync(iconsDir)
  .filter((file) => file.endsWith('.svg'))
  .sort();

// Generate the icon mapping
const iconNames = svgFiles.map((file) => file.replace('.svg', ''));

// Generate TypeScript file content for iconOptions.ts
const imports = iconNames
  .map((name) => {
    const importName = name.replace(/-/g, '_');
    return `import ${importName}Component from '../../icons/${name}.svg?react';`;
  })
  .join('\n');

const mapping = iconNames
  .map((name) => {
    const importName = name.replace(/-/g, '_');
    return `  '${name}': ${importName}Component,`;
  })
  .join('\n');

const iconOptionsContent = `// This file is auto-generated by scripts/build-icon-mapping.js
// Do not edit manually - run 'npm run build:icons' to regenerate

import React from 'react';
${imports}

export const iconOptions: Record<string, React.FC<React.SVGProps<SVGSVGElement> & { title?: string }>> = {
${mapping}
};
`;

// Generate TypeScript file content for iconNames.ts
const iconNameTypes = iconNames
  .map((name) => `  | '${name}'`)
  .join('\n');

const iconNamesContent = `// This file contains all valid icon names as a union type
// This ensures TypeScript will error on invalid icon names
// This file is auto-generated by scripts/build-icon-mapping.js
// Do not edit manually - run 'npm run build:icons' to regenerate

export type IconName =
${iconNameTypes}
;
`;

fs.writeFileSync(iconOptionsFile, iconOptionsContent, 'utf8');
fs.writeFileSync(iconNamesFile, iconNamesContent, 'utf8');
console.log(`Generated icon mapping with ${iconNames.length} icons`);

